<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="450" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: 'Source Han Sans CN', sans-serif; font-size: 16px; font-weight: bold; fill: #1e3a8a; }
      .subtitle { font-family: 'Source Han Sans CN', sans-serif; font-size: 14px; font-weight: bold; fill: #059669; }
      .label { font-family: 'Source Han Sans CN', sans-serif; font-size: 12px; fill: #374151; }
      .formula { font-family: 'Courier New', monospace; font-size: 11px; fill: #374151; }
      .axis { stroke: #374151; stroke-width: 2; }
      .grid { stroke: #e5e7eb; stroke-width: 1; }
      .poisson { stroke: #ef4444; stroke-width: 2; fill: none; }
      .nb { stroke: #3b82f6; stroke-width: 3; fill: none; }
      .data-points { fill: #6b7280; }
    </style>
  </defs>
  
  <!-- Title -->
  <text x="400" y="25" text-anchor="middle" class="title">RNA-seq数据的负二项分布模型</text>
  
  <!-- Left panel: Distribution comparison -->
  <text x="200" y="60" text-anchor="middle" class="subtitle">分布模型比较</text>
  
  <!-- Grid -->
  <g class="grid">
    <line x1="50" y1="80" x2="50" y2="250"/>
    <line x1="50" y1="250" x2="350" y2="250"/>
    <line x1="100" y1="80" x2="100" y2="250"/>
    <line x1="150" y1="80" x2="150" y2="250"/>
    <line x1="200" y1="80" x2="200" y2="250"/>
    <line x1="250" y1="80" x2="250" y2="250"/>
    <line x1="300" y1="80" x2="300" y2="250"/>
    <line x1="50" y1="100" x2="350" y2="100"/>
    <line x1="50" y1="150" x2="350" y2="150"/>
    <line x1="50" y1="200" x2="350" y2="200"/>
  </g>
  
  <!-- Axes -->
  <line x1="50" y1="80" x2="50" y2="250" class="axis"/>
  <line x1="50" y1="250" x2="350" y2="250" class="axis"/>
  
  <!-- Axis labels -->
  <text x="200" y="275" text-anchor="middle" class="label">表达计数值</text>
  <text x="25" y="165" text-anchor="middle" class="label" transform="rotate(-90, 25, 165)">概率密度</text>
  
  <!-- Poisson distribution curve -->
  <path d="M 60 240 Q 100 200 140 180 Q 180 170 220 175 Q 260 185 300 210" class="poisson"/>
  
  <!-- Negative binomial curve -->
  <path d="M 60 230 Q 100 160 140 120 Q 180 100 220 110 Q 260 130 300 180" class="nb"/>
  
  <!-- Data points (overdispersed) -->
  <circle cx="80" cy="220" r="3" class="data-points"/>
  <circle cx="100" cy="180" r="3" class="data-points"/>
  <circle cx="120" cy="140" r="3" class="data-points"/>
  <circle cx="140" cy="130" r="3" class="data-points"/>
  <circle cx="160" cy="125" r="3" class="data-points"/>
  <circle cx="180" cy="120" r="3" class="data-points"/>
  <circle cx="200" cy="130" r="3" class="data-points"/>
  <circle cx="220" cy="140" r="3" class="data-points"/>
  <circle cx="240" cy="160" r="3" class="data-points"/>
  <circle cx="260" cy="180" r="3" class="data-points"/>
  
  <!-- Legend -->
  <line x1="60" y1="290" x2="80" y2="290" class="poisson"/>
  <text x="85" y="295" class="label">泊松分布 (方差=均值)</text>
  
  <line x1="200" y1="290" x2="220" y2="290" class="nb"/>
  <text x="225" y="295" class="label">负二项分布 (方差>均值)</text>
  
  <circle cx="300" cy="290" r="3" class="data-points"/>
  <text x="310" y="295" class="label">实际RNA-seq数据</text>
  
  <!-- Right panel: Model parameters -->
  <text x="600" y="60" text-anchor="middle" class="subtitle">负二项分布参数</text>
  
  <rect x="450" y="80" width="300" height="180" fill="#f9fafb" stroke="#d1d5db" stroke-width="1" rx="5"/>
  
  <!-- Mathematical formulation -->
  <text x="470" y="105" class="label" style="font-weight: bold;">概率质量函数:</text>
  <text x="470" y="125" class="formula">P(X = k) = C(k+r-1, k) × p^r × (1-p)^k</text>
  
  <text x="470" y="150" class="label" style="font-weight: bold;">参数含义:</text>
  <text x="470" y="170" class="label">• μ (均值): 基因的平均表达水平</text>
  <text x="470" y="185" class="label">• φ (离散参数): 过度离散程度</text>
  <text x="470" y="200" class="label">• 方差 = μ + φμ²</text>
  
  <text x="470" y="225" class="label" style="font-weight: bold;">生物学解释:</text>
  <text x="470" y="240" class="label">• μ 反映基因表达强度</text>
  <text x="470" y="255" class="label">• φ 反映生物学变异和技术噪音</text>
  
  <!-- Bottom panel: DESeq2 workflow -->
  <text x="400" y="300" text-anchor="middle" class="subtitle">DESeq2分析流程</text>
  
  <rect x="50" y="320" width="700" height="100" fill="#f0f9ff" stroke="#0ea5e9" stroke-width="1" rx="5"/>
  
  <!-- Workflow steps -->
  <rect x="70" y="340" width="100" height="30" fill="#3b82f6" rx="3"/>
  <text x="120" y="360" text-anchor="middle" class="label" style="fill: white; font-weight: bold;">估计离散参数</text>
  
  <path d="M 180 355 L 200 355" stroke="#374151" stroke-width="2"/>
  <path d="M 195 350 L 200 355 L 195 360" fill="#374151"/>
  
  <rect x="210" y="340" width="100" height="30" fill="#3b82f6" rx="3"/>
  <text x="260" y="360" text-anchor="middle" class="label" style="fill: white; font-weight: bold;">拟合GLM模型</text>
  
  <path d="M 320 355 L 340 355" stroke="#374151" stroke-width="2"/>
  <path d="M 335 350 L 340 355 L 335 360" fill="#374151"/>
  
  <rect x="350" y="340" width="100" height="30" fill="#3b82f6" rx="3"/>
  <text x="400" y="360" text-anchor="middle" class="label" style="fill: white; font-weight: bold;">Wald检验</text>
  
  <path d="M 460 355 L 480 355" stroke="#374151" stroke-width="2"/>
  <path d="M 475 350 L 480 355 L 475 360" fill="#374151"/>
  
  <rect x="490" y="340" width="100" height="30" fill="#3b82f6" rx="3"/>
  <text x="540" y="360" text-anchor="middle" class="label" style="fill: white; font-weight: bold;">多重检验校正</text>
  
  <path d="M 600 355 L 620 355" stroke="#374151" stroke-width="2"/>
  <path d="M 615 350 L 620 355 L 615 360" fill="#374151"/>
  
  <rect x="630" y="340" width="100" height="30" fill="#059669" rx="3"/>
  <text x="680" y="360" text-anchor="middle" class="label" style="fill: white; font-weight: bold;">差异基因</text>
  
  <!-- Key advantages -->
  <text x="70" y="390" class="label" style="font-weight: bold;">关键优势:</text>
  <text x="70" y="405" class="label">• 适合小样本量 • 处理过度离散 • 稳健的统计推断 • 考虑生物学变异</text>
</svg>
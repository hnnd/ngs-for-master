<?xml version="1.0" encoding="UTF-8"?>
<svg width="1000" height="800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: "Source Han Sans CN", "Microsoft YaHei", Arial, sans-serif; font-size: 18px; font-weight: bold; }
      .subtitle { font-family: "Source Han Sans CN", "Microsoft YaHei", Arial, sans-serif; font-size: 14px; font-weight: bold; }
      .text { font-family: "Source Han Sans CN", "Microsoft YaHei", Arial, sans-serif; font-size: 12px; }
      .small-text { font-family: "Source Han Sans CN", "Microsoft YaHei", Arial, sans-serif; font-size: 10px; }
      .code-text { font-family: 'Courier New', monospace; font-size: 10px; }
      .header-box { fill: #f8f9fa; stroke: #6c757d; stroke-width: 1; }
      .field-box { fill: #e8f4fd; stroke: #1f77b4; stroke-width: 1; }
      .flag-box { fill: #fff2cc; stroke: #d6b656; stroke-width: 1; }
      .cigar-box { fill: #f0f8e8; stroke: #2ca02c; stroke-width: 1; }
    </style>
  </defs>
  
  <!-- 标题 -->
  <text x="500" y="30" text-anchor="middle" class="title">SAM/BAM文件格式详解</text>
  
  <!-- SAM文件结构 -->
  <text x="50" y="70" class="subtitle">SAM文件结构</text>
  
  <!-- 头部信息 -->
  <rect x="50" y="80" width="900" height="80" class="header-box" />
  <text x="60" y="100" class="text">头部信息 (Header):</text>
  <text x="60" y="115" class="code-text">@HD VN:1.6 SO:coordinate</text>
  <text x="60" y="130" class="code-text">@SQ SN:chr1 LN:248956422</text>
  <text x="60" y="145" class="code-text">@PG ID:bwa PN:bwa VN:0.7.17</text>
  
  <!-- 比对记录 -->
  <rect x="50" y="170" width="900" height="60" fill="white" stroke="#dee2e6" stroke-width="1" />
  <text x="60" y="190" class="text">比对记录 (Alignment Records):</text>
  <text x="60" y="205" class="code-text">read1 99 chr1 1000 60 100M = 1200 300 ATCG... IIII...</text>
  <text x="60" y="220" class="code-text">read2 147 chr1 1200 60 100M = 1000 -300 GCTA... IIII...</text>
  
  <!-- 字段详解 -->
  <text x="50" y="270" class="subtitle">比对记录字段详解</text>
  
  <!-- 字段表格 -->
  <rect x="50" y="290" width="900" height="30" class="header-box" />
  <text x="70" y="310" class="text">字段</text>
  <text x="150" y="310" class="text">名称</text>
  <text x="250" y="310" class="text">类型</text>
  <text x="350" y="310" class="text">描述</text>
  <text x="600" y="310" class="text">示例</text>
  
  <!-- 字段1-6 -->
  <rect x="50" y="320" width="900" height="25" fill="white" stroke="#dee2e6" stroke-width="0.5" />
  <text x="70" y="337" class="small-text">1</text>
  <text x="150" y="337" class="small-text">QNAME</text>
  <text x="250" y="337" class="small-text">String</text>
  <text x="350" y="337" class="small-text">查询序列名称</text>
  <text x="600" y="337" class="code-text">read_001</text>
  
  <rect x="50" y="345" width="900" height="25" fill="#f8f9fa" stroke="#dee2e6" stroke-width="0.5" />
  <text x="70" y="362" class="small-text">2</text>
  <text x="150" y="362" class="small-text">FLAG</text>
  <text x="250" y="362" class="small-text">Int</text>
  <text x="350" y="362" class="small-text">比对标志位</text>
  <text x="600" y="362" class="code-text">99</text>
  
  <rect x="50" y="370" width="900" height="25" fill="white" stroke="#dee2e6" stroke-width="0.5" />
  <text x="70" y="387" class="small-text">3</text>
  <text x="150" y="387" class="small-text">RNAME</text>
  <text x="250" y="387" class="small-text">String</text>
  <text x="350" y="387" class="small-text">参考序列名称</text>
  <text x="600" y="387" class="code-text">chr1</text>
  
  <rect x="50" y="395" width="900" height="25" fill="#f8f9fa" stroke="#dee2e6" stroke-width="0.5" />
  <text x="70" y="412" class="small-text">4</text>
  <text x="150" y="412" class="small-text">POS</text>
  <text x="250" y="412" class="small-text">Int</text>
  <text x="350" y="412" class="small-text">比对起始位置 (1-based)</text>
  <text x="600" y="412" class="code-text">1000</text>
  
  <rect x="50" y="420" width="900" height="25" fill="white" stroke="#dee2e6" stroke-width="0.5" />
  <text x="70" y="437" class="small-text">5</text>
  <text x="150" y="437" class="small-text">MAPQ</text>
  <text x="250" y="437" class="small-text">Int</text>
  <text x="350" y="437" class="small-text">比对质量值</text>
  <text x="600" y="437" class="code-text">60</text>
  
  <rect x="50" y="445" width="900" height="25" fill="#f8f9fa" stroke="#dee2e6" stroke-width="0.5" />
  <text x="70" y="462" class="small-text">6</text>
  <text x="150" y="462" class="small-text">CIGAR</text>
  <text x="250" y="462" class="small-text">String</text>
  <text x="350" y="462" class="small-text">比对描述字符串</text>
  <text x="600" y="462" class="code-text">100M</text>
  
  <!-- FLAG字段详解 -->
  <text x="50" y="500" class="subtitle">FLAG字段详解</text>
  
  <rect x="50" y="520" width="450" height="200" class="flag-box" />
  <text x="60" y="540" class="text">二进制标志位:</text>
  
  <text x="60" y="560" class="small-text">0x1 (1): 配对测序</text>
  <text x="60" y="575" class="small-text">0x2 (2): 正确配对</text>
  <text x="60" y="590" class="small-text">0x4 (4): 未比对</text>
  <text x="60" y="605" class="small-text">0x8 (8): 配对read未比对</text>
  <text x="60" y="620" class="small-text">0x10 (16): 反向互补</text>
  <text x="60" y="635" class="small-text">0x20 (32): 配对read反向互补</text>
  <text x="60" y="650" class="small-text">0x40 (64): 第一条read</text>
  <text x="60" y="665" class="small-text">0x80 (128): 第二条read</text>
  <text x="60" y="680" class="small-text">0x100 (256): 次要比对</text>
  <text x="60" y="695" class="small-text">0x200 (512): 质控失败</text>
  <text x="60" y="710" class="small-text">0x400 (1024): PCR重复</text>
  
  <!-- CIGAR字符串详解 -->
  <rect x="520" y="520" width="430" height="200" class="cigar-box" />
  <text x="530" y="540" class="text">CIGAR操作符:</text>
  
  <text x="530" y="560" class="small-text">M: 匹配/错配 (alignment match)</text>
  <text x="530" y="575" class="small-text">I: 插入 (insertion to reference)</text>
  <text x="530" y="590" class="small-text">D: 删除 (deletion from reference)</text>
  <text x="530" y="605" class="small-text">N: 跳跃 (skipped region)</text>
  <text x="530" y="620" class="small-text">S: 软剪切 (soft clipping)</text>
  <text x="530" y="635" class="small-text">H: 硬剪切 (hard clipping)</text>
  <text x="530" y="650" class="small-text">P: 填充 (padding)</text>
  <text x="530" y="665" class="small-text">=: 精确匹配 (sequence match)</text>
  <text x="530" y="680" class="small-text">X: 序列错配 (sequence mismatch)</text>
  
  <text x="530" y="700" class="text">示例:</text>
  <text x="530" y="715" class="code-text">100M: 100bp完全匹配</text>
  
  <!-- MAPQ值解释 -->
  <text x="50" y="750" class="subtitle">MAPQ质量值解释</text>
  
  <rect x="50" y="760" width="900" height="30" class="header-box" />
  <text x="70" y="780" class="text">MAPQ值</text>
  <text x="150" y="780" class="text">错误概率</text>
  <text x="250" y="780" class="text">质量等级</text>
  <text x="400" y="780" class="text">含义</text>
  <text x="700" y="780" class="text">建议</text>
  
  <rect x="50" y="790" width="900" height="20" fill="white" stroke="#dee2e6" stroke-width="0.5" />
  <text x="70" y="805" class="small-text">0</text>
  <text x="150" y="805" class="small-text">100%</text>
  <text x="250" y="805" class="small-text">无效</text>
  <text x="400" y="805" class="small-text">多重比对或未比对</text>
  <text x="700" y="805" class="small-text">过滤掉</text>
  
  <rect x="50" y="810" width="900" height="20" fill="#f8f9fa" stroke="#dee2e6" stroke-width="0.5" />
  <text x="70" y="825" class="small-text">20</text>
  <text x="150" y="825" class="small-text">1%</text>
  <text x="250" y="825" class="small-text">中等</text>
  <text x="400" y="825" class="small-text">中等质量比对</text>
  <text x="700" y="825" class="small-text">谨慎使用</text>
  
  <rect x="50" y="830" width="900" height="20" fill="white" stroke="#dee2e6" stroke-width="0.5" />
  <text x="70" y="845" class="small-text">30</text>
  <text x="150" y="845" class="small-text">0.1%</text>
  <text x="250" y="845" class="small-text">高</text>
  <text x="400" y="845" class="small-text">高质量比对</text>
  <text x="700" y="845" class="small-text">可信赖</text>
  
  <rect x="50" y="850" width="900" height="20" fill="#f8f9fa" stroke="#dee2e6" stroke-width="0.5" />
  <text x="70" y="865" class="small-text">60</text>
  <text x="150" y="865" class="small-text">0.0001%</text>
  <text x="250" y="865" class="small-text">极高</text>
  <text x="400" y="865" class="small-text">极高质量比对</text>
  <text x="700" y="865" class="small-text">高度可信</text>
</svg>
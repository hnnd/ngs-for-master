<?xml version="1.0" encoding="UTF-8"?>
<svg width="900" height="700" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: 'Source Han Sans CN', sans-serif; font-size: 18px; font-weight: bold; fill: #1e3a8a; }
      .section { font-family: 'Source Han Sans CN', sans-serif; font-size: 14px; font-weight: bold; fill: #374151; }
      .label { font-family: 'Source Han Sans CN', sans-serif; font-size: 12px; fill: #4b5563; }
      .track-label { font-family: 'Source Han Sans CN', sans-serif; font-size: 10px; fill: #6b7280; }
      .coordinate { font-family: 'Source Han Sans CN', sans-serif; font-size: 9px; fill: #9ca3af; }
      .peak-signal { fill: #10b981; opacity: 0.7; }
      .input-signal { fill: #6b7280; opacity: 0.5; }
      .gene { fill: #3b82f6; stroke: #1d4ed8; stroke-width: 1; }
      .exon { fill: #1d4ed8; }
      .peak-region { fill: #fbbf24; stroke: #f59e0b; stroke-width: 2; opacity: 0.3; }
    </style>
  </defs>
  
  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" class="title">ChIP-seq&#32467;&#26524;&#21487;&#35270;&#21270;&#31034;&#20363;</text>
  
  <!-- Genome Browser View -->
  <g transform="translate(50, 60)">
    <rect x="0" y="0" width="800" height="300" fill="#f9fafb" stroke="#e5e7eb" stroke-width="1" rx="4"/>
    <text x="400" y="20" text-anchor="middle" class="section">&#22522;&#22240;&#32452;&#27983;&#35272;&#22120;&#35270;&#22270; (IGV&#39118;&#26684;&#24335;)</text>
    
    <!-- Coordinate ruler -->
    <g transform="translate(50, 40)">
      <line x1="0" y1="0" x2="700" y2="0" stroke="#d1d5db" stroke-width="1"/>
      <text x="0" y="-5" class="coordinate">chr1:1,000,000</text>
      <text x="175" y="-5" class="coordinate">1,005,000</text>
      <text x="350" y="-5" class="coordinate">1,010,000</text>
      <text x="525" y="-5" class="coordinate">1,015,000</text>
      <text x="700" y="-5" class="coordinate">1,020,000</text>
      
      <!-- Tick marks -->
      <line x1="0" y1="-3" x2="0" y2="3" stroke="#9ca3af" stroke-width="1"/>
      <line x1="175" y1="-3" x2="175" y2="3" stroke="#9ca3af" stroke-width="1"/>
      <line x1="350" y1="-3" x2="350" y2="3" stroke="#9ca3af" stroke-width="1"/>
      <line x1="525" y1="-3" x2="525" y2="3" stroke="#9ca3af" stroke-width="1"/>
      <line x1="700" y1="-3" x2="700" y2="3" stroke="#9ca3af" stroke-width="1"/>
    </g>
    
    <!-- Gene annotation track -->
    <g transform="translate(50, 60)">
      <text x="-40" y="15" class="track-label">&#22522;&#22240;&#27880;&#37322;</text>
      
      <!-- Gene structure -->
      <rect x="100" y="5" width="300" height="8" class="gene" rx="2"/>
      <rect x="120" y="3" width="40" height="12" class="exon" rx="1"/>
      <rect x="180" y="3" width="60" height="12" class="exon" rx="1"/>
      <rect x="260" y="3" width="50" height="12" class="exon" rx="1"/>
      <rect x="330" y="3" width="45" height="12" class="exon" rx="1"/>
      
      <!-- Gene name -->
      <text x="225" y="25" text-anchor="middle" class="label">GENE1</text>
      
      <!-- Transcription direction arrow -->
      <polygon points="380,9 390,9 385,13" fill="#1d4ed8"/>
    </g>
    
    <!-- H3K4me3 ChIP-seq track -->
    <g transform="translate(50, 100)">
      <text x="-40" y="15" class="track-label">H3K4me3</text>
      
      <!-- Signal track -->
      <rect x="0" y="20" width="700" height="40" fill="#f3f4f6" stroke="#d1d5db" stroke-width="1"/>
      
      <!-- Peak signal -->
      <path d="M100 60 L110 50 L130 30 L150 25 L170 30 L190 35 L210 40 L230 45 L250 50 L270 55 L290 60" 
            class="peak-signal" stroke="#10b981" stroke-width="2" fill="none"/>
      <path d="M100 60 L110 50 L130 30 L150 25 L170 30 L190 35 L210 40 L230 45 L250 50 L270 55 L290 60 L290 60 L100 60" 
            class="peak-signal"/>
      
      <!-- Scale -->
      <text x="710" y="30" class="coordinate">100</text>
      <text x="710" y="45" class="coordinate">50</text>
      <text x="710" y="60" class="coordinate">0</text>
    </g>
    
    <!-- H3K27ac ChIP-seq track -->
    <g transform="translate(50, 180)">
      <text x="-40" y="15" class="track-label">H3K27ac</text>
      
      <!-- Signal track -->
      <rect x="0" y="20" width="700" height="40" fill="#f3f4f6" stroke="#d1d5db" stroke-width="1"/>
      
      <!-- Peak signal -->
      <path d="M80 60 L90 55 L110 40 L130 35 L150 40 L170 45 L190 50 L210 55 L230 60" 
            class="peak-signal" stroke="#10b981" stroke-width="2" fill="none"/>
      <path d="M80 60 L90 55 L110 40 L130 35 L150 40 L170 45 L190 50 L210 55 L230 60 L230 60 L80 60" 
            class="peak-signal"/>
      
      <!-- Additional peak -->
      <path d="M400 60 L420 45 L440 35 L460 40 L480 50 L500 60" 
            class="peak-signal" stroke="#10b981" stroke-width="2" fill="none"/>
      <path d="M400 60 L420 45 L440 35 L460 40 L480 50 L500 60 L500 60 L400 60" 
            class="peak-signal"/>
      
      <!-- Scale -->
      <text x="710" y="30" class="coordinate">80</text>
      <text x="710" y="45" class="coordinate">40</text>
      <text x="710" y="60" class="coordinate">0</text>
    </g>
    
    <!-- Input control track -->
    <g transform="translate(50, 260)">
      <text x="-40" y="15" class="track-label">Input</text>
      
      <!-- Signal track -->
      <rect x="0" y="20" width="700" height="30" fill="#f3f4f6" stroke="#d1d5db" stroke-width="1"/>
      
      <!-- Background signal -->
      <path d="M0 50 L50 48 L100 47 L150 49 L200 48 L250 47 L300 49 L350 48 L400 47 L450 49 L500 48 L550 47 L600 49 L650 48 L700 50" 
            class="input-signal" stroke="#6b7280" stroke-width="1" fill="none"/>
      <path d="M0 50 L50 48 L100 47 L150 49 L200 48 L250 47 L300 49 L350 48 L400 47 L450 49 L500 48 L550 47 L600 49 L650 48 L700 50 L700 50 L0 50" 
            class="input-signal"/>
      
      <!-- Scale -->
      <text x="710" y="30" class="coordinate">20</text>
      <text x="710" y="50" class="coordinate">0</text>
    </g>
  </g>
  
  <!-- Peak calling results -->
  <g transform="translate(50, 380)">
    <rect x="0" y="0" width="380" height="120" fill="#f0fdf4" stroke="#16a34a" stroke-width="1" rx="4"/>
    <text x="190" y="20" text-anchor="middle" class="section">Peak Calling&#32467;&#26524;</text>
    
    <!-- Peak regions -->
    <rect x="20" y="30" width="340" height="20" fill="#f3f4f6" stroke="#d1d5db" stroke-width="1"/>
    <rect x="50" y="30" width="80" height="20" class="peak-region"/>
    <rect x="200" y="30" width="60" height="20" class="peak-region"/>
    
    <text x="20" y="65" class="label">Peak 1:</text>
    <text x="70" y="65" class="track-label">chr1:1,002,500-1,006,500 (q-value: 1.2e-15)</text>
    
    <text x="20" y="80" class="label">Peak 2:</text>
    <text x="70" y="80" class="track-label">chr1:1,012,000-1,015,000 (q-value: 3.4e-12)</text>
    
    <text x="20" y="95" class="label">&#24635;Peak&#25968;:</text>
    <text x="90" y="95" class="track-label">2,847&#20010;</text>
    
    <text x="200" y="95" class="label">FRiP Score:</text>
    <text x="270" y="95" class="track-label">12.3%</text>
  </g>
  
  <!-- Heatmap visualization -->
  <g transform="translate(470, 380)">
    <rect x="0" y="0" width="380" height="120" fill="#fef3c7" stroke="#f59e0b" stroke-width="1" rx="4"/>
    <text x="190" y="20" text-anchor="middle" class="section">&#28909;&#22270;&#21487;&#35270;&#21270;</text>
    
    <!-- Heatmap matrix -->
    <g transform="translate(50, 30)">
      <!-- Heatmap rows -->
      <rect x="0" y="0" width="280" height="3" fill="#dc2626"/>
      <rect x="0" y="5" width="280" height="3" fill="#ef4444"/>
      <rect x="0" y="10" width="280" height="3" fill="#f87171"/>
      <rect x="0" y="15" width="280" height="3" fill="#fca5a5"/>
      <rect x="0" y="20" width="280" height="3" fill="#fecaca"/>
      <rect x="0" y="25" width="280" height="3" fill="#fee2e2"/>
      <rect x="0" y="30" width="280" height="3" fill="#fef2f2"/>
      <rect x="0" y="35" width="280" height="3" fill="#f3f4f6"/>
      <rect x="0" y="40" width="280" height="3" fill="#e5e7eb"/>
      <rect x="0" y="45" width="280" height="3" fill="#d1d5db"/>
      
      <!-- Center line -->
      <line x1="140" y1="0" x2="140" y2="50" stroke="#374151" stroke-width="1" stroke-dasharray="2,2"/>
      
      <!-- Labels -->
      <text x="70" y="-5" text-anchor="middle" class="coordinate">-2kb</text>
      <text x="140" y="-5" text-anchor="middle" class="coordinate">TSS</text>
      <text x="210" y="-5" text-anchor="middle" class="coordinate">+2kb</text>
      
      <text x="-10" y="25" text-anchor="middle" class="coordinate">Peaks</text>
    </g>
    
    <text x="20" y="95" class="label">&#39640;&#20449;&#21495;:</text>
    <rect x="70" y="87" width="15" height="8" fill="#dc2626"/>
    
    <text x="120" y="95" class="label">&#20302;&#20449;&#21495;:</text>
    <rect x="170" y="87" width="15" height="8" fill="#f3f4f6"/>
  </g>
  
  <!-- Profile plot -->
  <g transform="translate(50, 520)">
    <rect x="0" y="0" width="380" height="120" fill="#eff6ff" stroke="#3b82f6" stroke-width="1" rx="4"/>
    <text x="190" y="20" text-anchor="middle" class="section">Profile&#22270;&#35889;</text>
    
    <!-- Plot area -->
    <g transform="translate(50, 30)">
      <rect x="0" y="0" width="280" height="60" fill="white" stroke="#d1d5db" stroke-width="1"/>
      
      <!-- Profile curve -->
      <path d="M0 50 Q70 45 140 20 Q210 45 280 50" 
            fill="none" stroke="#3b82f6" stroke-width="3"/>
      
      <!-- Confidence interval -->
      <path d="M0 55 Q70 50 140 25 Q210 50 280 55" 
            fill="none" stroke="#93c5fd" stroke-width="1" stroke-dasharray="3,3"/>
      <path d="M0 45 Q70 40 140 15 Q210 40 280 45" 
            fill="none" stroke="#93c5fd" stroke-width="1" stroke-dasharray="3,3"/>
      
      <!-- Center line -->
      <line x1="140" y1="0" x2="140" y2="60" stroke="#6b7280" stroke-width="1" stroke-dasharray="2,2"/>
      
      <!-- Axes -->
      <line x1="0" y1="60" x2="280" y2="60" stroke="#374151" stroke-width="1"/>
      <line x1="0" y1="0" x2="0" y2="60" stroke="#374151" stroke-width="1"/>
      
      <!-- Labels -->
      <text x="70" y="75" text-anchor="middle" class="coordinate">-2kb</text>
      <text x="140" y="75" text-anchor="middle" class="coordinate">TSS</text>
      <text x="210" y="75" text-anchor="middle" class="coordinate">+2kb</text>
      
      <text x="-15" y="10" text-anchor="middle" class="coordinate">100</text>
      <text x="-15" y="35" text-anchor="middle" class="coordinate">50</text>
      <text x="-15" y="60" text-anchor="middle" class="coordinate">0</text>
    </g>
    
    <text x="20" y="105" class="label">&#24179;&#22343;&#20449;&#21495;&#24378;&#24230;&#22312;TSS&#21608;&#22260;&#30340;&#20998;&#24067;</text>
  </g>
  
  <!-- Annotation pie chart -->
  <g transform="translate(470, 520)">
    <rect x="0" y="0" width="380" height="120" fill="#f5f3ff" stroke="#7c3aed" stroke-width="1" rx="4"/>
    <text x="190" y="20" text-anchor="middle" class="section">Peak&#27880;&#37322;&#32467;&#26524;</text>
    
    <!-- Pie chart -->
    <g transform="translate(100, 70)">
      <circle cx="0" cy="0" r="30" fill="#10b981"/>
      <path d="M0,0 L0,-30 A30,30 0 0,1 21.2,-21.2 Z" fill="#3b82f6"/>
      <path d="M0,0 L21.2,-21.2 A30,30 0 0,1 30,0 Z" fill="#f59e0b"/>
      <path d="M0,0 L30,0 A30,30 0 0,1 0,30 Z" fill="#ef4444"/>
      <path d="M0,0 L0,30 A30,30 0 1,1 0,-30 Z" fill="#6b7280"/>
    </g>
    
    <!-- Legend -->
    <g transform="translate(200, 40)">
      <rect x="0" y="0" width="10" height="10" fill="#10b981"/>
      <text x="15" y="8" class="track-label">&#21551;&#21160;&#23376; (45%)</text>
      
      <rect x="0" y="15" width="10" height="10" fill="#3b82f6"/>
      <text x="15" y="23" class="track-label">&#22522;&#22240;&#20307; (25%)</text>
      
      <rect x="0" y="30" width="10" height="10" fill="#f59e0b"/>
      <text x="15" y="38" class="track-label">&#22686;&#24378;&#23376; (15%)</text>
      
      <rect x="0" y="45" width="10" height="10" fill="#ef4444"/>
      <text x="15" y="53" class="track-label">&#22522;&#22240;&#38388;&#21306; (10%)</text>
      
      <rect x="0" y="60" width="10" height="10" fill="#6b7280"/>
      <text x="15" y="68" class="track-label">&#20854;&#20182; (5%)</text>
    </g>
  </g>
  
  <!-- Tools and formats -->
  <g transform="translate(50, 660)">
    <rect x="0" y="0" width="800" height="30" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1" rx="4"/>
    <text x="20" y="18" class="label">&#24120;&#29992;&#21487;&#35270;&#21270;&#24037;&#20855;&#65306;</text>
    <text x="140" y="18" class="track-label">IGV, UCSC Genome Browser, deepTools, ChIPseeker, ngsplot</text>
    
    <text x="500" y="18" class="label">&#25991;&#20214;&#26684;&#24335;&#65306;</text>
    <text x="580" y="18" class="track-label">BAM, bigWig, BED, narrowPeak</text>
  </g>
</svg>
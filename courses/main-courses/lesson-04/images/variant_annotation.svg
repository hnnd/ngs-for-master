<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: 'Source Han Sans CN', sans-serif; font-size: 18px; font-weight: bold; fill: #1e3a8a; }
      .subtitle { font-family: 'Source Han Sans CN', sans-serif; font-size: 14px; font-weight: bold; fill: #374151; }
      .text { font-family: 'Source Han Sans CN', sans-serif; font-size: 12px; fill: #4b5563; }
      .step-text { font-family: 'Source Han Sans CN', sans-serif; font-size: 11px; fill: white; font-weight: bold; }
      .detail-text { font-family: 'Source Han Sans CN', sans-serif; font-size: 10px; fill: #6b7280; }
      .vcf { font-family: 'Courier New', monospace; font-size: 9px; fill: #374151; }
    </style>
  </defs>
  
  <!-- 标题 -->
  <text x="400" y="30" text-anchor="middle" class="title">变异注释流程</text>
  
  <!-- 输入VCF -->
  <g transform="translate(50, 60)">
    <rect x="0" y="0" width="120" height="50" rx="8" fill="#6b7280" stroke="#4b5563"/>
    <text x="60" y="20" text-anchor="middle" class="step-text">原始VCF</text>
    <text x="60" y="35" text-anchor="middle" class="step-text">变异位点</text>
    
    <!-- VCF示例 -->
    <text x="0" y="70" class="vcf">chr1 1000 . G A 99.9 PASS DP=50</text>
    <text x="0" y="85" class="vcf">chr2 2000 . ATG A 89.5 PASS DP=40</text>
  </g>
  
  <!-- 箭头 -->
  <path d="M 170 85 L 210 85" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- 基因位置注释 -->
  <g transform="translate(220, 60)">
    <rect x="0" y="0" width="120" height="50" rx="8" fill="#3b82f6" stroke="#1d4ed8"/>
    <text x="60" y="20" text-anchor="middle" class="step-text">基因位置</text>
    <text x="60" y="35" text-anchor="middle" class="step-text">注释</text>
    
    <!-- 注释信息 -->
    <text x="0" y="70" class="detail-text">• 基因名称: BRCA1</text>
    <text x="0" y="85" class="detail-text">• 转录本: ENST00000357654</text>
    <text x="0" y="100" class="detail-text">• 外显子: 11/24</text>
  </g>
  
  <!-- 箭头 -->
  <path d="M 340 85 L 380 85" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- 功能预测 -->
  <g transform="translate(390, 60)">
    <rect x="0" y="0" width="120" height="50" rx="8" fill="#059669" stroke="#047857"/>
    <text x="60" y="20" text-anchor="middle" class="step-text">功能预测</text>
    <text x="60" y="35" text-anchor="middle" class="step-text">注释</text>
    
    <!-- 预测结果 -->
    <text x="0" y="70" class="detail-text">• 变异类型: 错义变异</text>
    <text x="0" y="85" class="detail-text">• SIFT: 0.01 (有害)</text>
    <text x="0" y="100" class="detail-text">• PolyPhen: 0.95 (可能有害)</text>
  </g>
  
  <!-- 箭头 -->
  <path d="M 510 85 L 550 85" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- 人群频率 -->
  <g transform="translate(560, 60)">
    <rect x="0" y="0" width="120" height="50" rx="8" fill="#dc2626" stroke="#b91c1c"/>
    <text x="60" y="20" text-anchor="middle" class="step-text">人群频率</text>
    <text x="60" y="35" text-anchor="middle" class="step-text">注释</text>
    
    <!-- 频率信息 -->
    <text x="0" y="70" class="detail-text">• gnomAD: 0.0001</text>
    <text x="0" y="85" class="detail-text">• 1000G: 0.0002</text>
    <text x="0" y="100" class="detail-text">• ExAC: 0.00015</text>
  </g>
  
  <!-- 向下箭头 -->
  <path d="M 620 110 L 620 150" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- 疾病关联 -->
  <g transform="translate(560, 160)">
    <rect x="0" y="0" width="120" height="50" rx="8" fill="#7c3aed" stroke="#5b21b6"/>
    <text x="60" y="20" text-anchor="middle" class="step-text">疾病关联</text>
    <text x="60" y="35" text-anchor="middle" class="step-text">注释</text>
    
    <!-- 疾病信息 -->
    <text x="0" y="70" class="detail-text">• ClinVar: 致病性</text>
    <text x="0" y="85" class="detail-text">• OMIM: 乳腺癌</text>
    <text x="0" y="100" class="detail-text">• HGMD: DM</text>
  </g>
  
  <!-- 向左箭头 -->
  <path d="M 560 185 L 520 185" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- 保守性评分 -->
  <g transform="translate(390, 160)">
    <rect x="0" y="0" width="120" height="50" rx="8" fill="#f59e0b" stroke="#d97706"/>
    <text x="60" y="20" text-anchor="middle" class="step-text">保守性</text>
    <text x="60" y="35" text-anchor="middle" class="step-text">评分</text>
    
    <!-- 保守性信息 -->
    <text x="0" y="70" class="detail-text">• PhyloP: 2.5</text>
    <text x="0" y="85" class="detail-text">• PhastCons: 0.98</text>
    <text x="0" y="100" class="detail-text">• GERP++: 5.2</text>
  </g>
  
  <!-- 向左箭头 -->
  <path d="M 390 185 L 350 185" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- 最终注释结果 -->
  <g transform="translate(220, 160)">
    <rect x="0" y="0" width="120" height="50" rx="8" fill="#10b981" stroke="#059669"/>
    <text x="60" y="20" text-anchor="middle" class="step-text">综合注释</text>
    <text x="60" y="35" text-anchor="middle" class="step-text">VCF</text>
  </g>
  
  <!-- 注释工具比较 -->
  <g transform="translate(50, 280)">
    <text x="0" y="0" class="subtitle">主要注释工具比较</text>
    
    <rect x="0" y="20" width="700" height="150" fill="#f9fafb" stroke="#e5e7eb" rx="5"/>
    
    <!-- 表头 -->
    <text x="20" y="40" class="text" font-weight="bold">工具</text>
    <text x="100" y="40" class="text" font-weight="bold">开发者</text>
    <text x="200" y="40" class="text" font-weight="bold">特点</text>
    <text x="400" y="40" class="text" font-weight="bold">优势</text>
    <text x="550" y="40" class="text" font-weight="bold">适用场景</text>
    
    <!-- VEP -->
    <text x="20" y="60" class="text">VEP</text>
    <text x="100" y="60" class="text">Ensembl</text>
    <text x="200" y="60" class="text">功能全面，在线/本地</text>
    <text x="400" y="60" class="text">标准化输出</text>
    <text x="550" y="60" class="text">研究和临床</text>
    
    <!-- ANNOVAR -->
    <text x="20" y="80" class="text">ANNOVAR</text>
    <text x="100" y="80" class="text">王凯实验室</text>
    <text x="200" y="80" class="text">数据库丰富</text>
    <text x="400" y="80" class="text">命令行友好</text>
    <text x="550" y="80" class="text">批量处理</text>
    
    <!-- SnpEff -->
    <text x="20" y="100" class="text">SnpEff</text>
    <text x="100" y="100" class="text">Pablo Cingolani</text>
    <text x="200" y="100" class="text">轻量级，快速</text>
    <text x="400" y="100" class="text">统计报告</text>
    <text x="550" y="100" class="text">流程集成</text>
    
    <!-- ClinEff -->
    <text x="20" y="120" class="text">ClinEff</text>
    <text x="100" y="120" class="text">多个机构</text>
    <text x="200" y="120" class="text">临床导向</text>
    <text x="400" y="120" class="text">临床解读</text>
    <text x="550" y="120" class="text">临床诊断</text>
    
    <!-- InterVar -->
    <text x="20" y="140" class="text">InterVar</text>
    <text x="100" y="140" class="text">王凯实验室</text>
    <text x="200" y="140" class="text">ACMG指南</text>
    <text x="400" y="140" class="text">自动分类</text>
    <text x="550" y="140" class="text">临床报告</text>
    
    <!-- wANNOVAR -->
    <text x="20" y="160" class="text">wANNOVAR</text>
    <text x="100" y="160" class="text">王凯实验室</text>
    <text x="200" y="160" class="text">Web界面</text>
    <text x="400" y="160" class="text">用户友好</text>
    <text x="550" y="160" class="text">小规模分析</text>
  </g>
  
  <!-- 注释数据库 -->
  <g transform="translate(50, 460)">
    <text x="0" y="0" class="subtitle">重要注释数据库</text>
    
    <!-- 基因组注释 -->
    <rect x="0" y="20" width="150" height="100" fill="#f0f9ff" stroke="#3b82f6" rx="5"/>
    <text x="10" y="35" class="text" font-weight="bold">基因组注释</text>
    <text x="10" y="50" class="detail-text">• RefSeq</text>
    <text x="10" y="65" class="detail-text">• Ensembl</text>
    <text x="10" y="80" class="detail-text">• GENCODE</text>
    <text x="10" y="95" class="detail-text">• UCSC Known Genes</text>
    <text x="10" y="110" class="detail-text">• LRG</text>
    
    <!-- 功能预测 -->
    <rect x="170" y="20" width="150" height="100" fill="#f0fdf4" stroke="#22c55e" rx="5"/>
    <text x="180" y="35" class="text" font-weight="bold">功能预测</text>
    <text x="180" y="50" class="detail-text">• SIFT</text>
    <text x="180" y="65" class="detail-text">• PolyPhen-2</text>
    <text x="180" y="80" class="detail-text">• CADD</text>
    <text x="180" y="95" class="detail-text">• REVEL</text>
    <text x="180" y="110" class="detail-text">• MutationTaster</text>
    
    <!-- 人群频率 -->
    <rect x="340" y="20" width="150" height="100" fill="#fef2f2" stroke="#ef4444" rx="5"/>
    <text x="350" y="35" class="text" font-weight="bold">人群频率</text>
    <text x="350" y="50" class="detail-text">• gnomAD</text>
    <text x="350" y="65" class="detail-text">• 1000 Genomes</text>
    <text x="350" y="80" class="detail-text">• ExAC</text>
    <text x="350" y="95" class="detail-text">• ESP6500</text>
    <text x="350" y="110" class="detail-text">• UK10K</text>
    
    <!-- 疾病数据库 -->
    <rect x="510" y="20" width="150" height="100" fill="#fef3c7" stroke="#f59e0b" rx="5"/>
    <text x="520" y="35" class="text" font-weight="bold">疾病数据库</text>
    <text x="520" y="50" class="detail-text">• ClinVar</text>
    <text x="520" y="65" class="detail-text">• HGMD</text>
    <text x="520" y="80" class="detail-text">• OMIM</text>
    <text x="520" y="95" class="detail-text">• COSMIC</text>
    <text x="520" y="110" class="detail-text">• dbSNP</text>
  </g>
  
  <!-- 箭头标记定义 -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151"/>
    </marker>
  </defs>
</svg>
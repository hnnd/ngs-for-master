<?xml version="1.0" encoding="UTF-8"?>
<svg width="900" height="500" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title-text { font-family: "Source Han Sans CN", "Microsoft YaHei", Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #1f2937; }
      .step-text { font-family: "Source Han Sans CN", "Microsoft YaHei", Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #1f2937; }
      .desc-text { font-family: "Source Han Sans CN", "Microsoft YaHei", Arial, sans-serif; font-size: 11px; fill: #374151; }
      .cell { fill: #fbbf24; stroke: #f59e0b; stroke-width: 2; }
      .droplet { fill: #60a5fa; stroke: #3b82f6; stroke-width: 2; opacity: 0.7; }
      .dna { stroke: #dc2626; stroke-width: 3; fill: none; }
      .arrow { stroke: #059669; stroke-width: 2; fill: #059669; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
            refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#059669" />
    </marker>
  </defs>
  
  <!-- 标题 -->
  <text x="450" y="30" text-anchor="middle" class="title-text">10X Genomics单细胞测序技术原理</text>
  
  <!-- 步骤1: 细胞悬液 -->
  <g transform="translate(50, 80)">
    <rect x="0" y="0" width="120" height="100" fill="#f9fafb" stroke="#d1d5db" rx="5"/>
    <text x="60" y="20" text-anchor="middle" class="step-text">步骤1</text>
    <text x="60" y="35" text-anchor="middle" class="desc-text">细胞悬液制备</text>
    
    <!-- 细胞 -->
    <circle cx="30" cy="60" r="8" class="cell"/>
    <circle cx="60" cy="70" r="8" class="cell"/>
    <circle cx="90" cy="55" r="8" class="cell"/>
    <text x="60" y="95" text-anchor="middle" class="desc-text">单细胞悬液</text>
  </g>
  
  <!-- 箭头1 -->
  <line x1="170" y1="130" x2="210" y2="130" class="arrow" marker-end="url(#arrowhead)"/>
  
  <!-- 步骤2: 微滴包裹 -->
  <g transform="translate(220, 80)">
    <rect x="0" y="0" width="120" height="100" fill="#f9fafb" stroke="#d1d5db" rx="5"/>
    <text x="60" y="20" text-anchor="middle" class="step-text">步骤2</text>
    <text x="60" y="35" text-anchor="middle" class="desc-text">微滴包裹</text>
    
    <!-- 微滴中的细胞 -->
    <circle cx="60" cy="65" r="20" class="droplet"/>
    <circle cx="60" cy="65" r="8" class="cell"/>
    <text x="60" y="95" text-anchor="middle" class="desc-text">单细胞微滴</text>
  </g>
  
  <!-- 箭头2 -->
  <line x1="340" y1="130" x2="380" y2="130" class="arrow" marker-end="url(#arrowhead)"/>
  
  <!-- 步骤3: 细胞裂解 -->
  <g transform="translate(390, 80)">
    <rect x="0" y="0" width="120" height="100" fill="#f9fafb" stroke="#d1d5db" rx="5"/>
    <text x="60" y="20" text-anchor="middle" class="step-text">步骤3</text>
    <text x="60" y="35" text-anchor="middle" class="desc-text">细胞裂解</text>
    
    <!-- 裂解后的mRNA -->
    <circle cx="60" cy="65" r="20" class="droplet"/>
    <path d="M 45 60 Q 60 50 75 60" class="dna"/>
    <path d="M 45 70 Q 60 80 75 70" class="dna"/>
    <text x="60" y="95" text-anchor="middle" class="desc-text">释放mRNA</text>
  </g>
  
  <!-- 箭头3 -->
  <line x1="510" y1="130" x2="550" y2="130" class="arrow" marker-end="url(#arrowhead)"/>
  
  <!-- 步骤4: 逆转录 -->
  <g transform="translate(560, 80)">
    <rect x="0" y="0" width="120" height="100" fill="#f9fafb" stroke="#d1d5db" rx="5"/>
    <text x="60" y="20" text-anchor="middle" class="step-text">步骤4</text>
    <text x="60" y="35" text-anchor="middle" class="desc-text">逆转录</text>
    
    <!-- cDNA -->
    <circle cx="60" cy="65" r="20" class="droplet"/>
    <rect x="50" y="60" width="20" height="3" fill="#dc2626"/>
    <rect x="50" y="67" width="20" height="3" fill="#dc2626"/>
    <text x="60" y="95" text-anchor="middle" class="desc-text">合成cDNA</text>
  </g>
  
  <!-- 箭头4 -->
  <line x1="680" y1="130" x2="720" y2="130" class="arrow" marker-end="url(#arrowhead)"/>
  
  <!-- 步骤5: 测序 -->
  <g transform="translate(730, 80)">
    <rect x="0" y="0" width="120" height="100" fill="#f9fafb" stroke="#d1d5db" rx="5"/>
    <text x="60" y="20" text-anchor="middle" class="step-text">步骤5</text>
    <text x="60" y="35" text-anchor="middle" class="desc-text">高通量测序</text>
    
    <!-- 测序仪示意 -->
    <rect x="40" y="50" width="40" height="25" fill="#6b7280" rx="3"/>
    <text x="60" y="95" text-anchor="middle" class="desc-text">获得序列数据</text>
  </g>
  
  <!-- 关键技术特点 -->
  <g transform="translate(50, 220)">
    <rect x="0" y="0" width="800" height="200" fill="#f0f9ff" stroke="#0ea5e9" rx="10"/>
    <text x="400" y="25" text-anchor="middle" class="step-text" fill="#0ea5e9">关键技术特点</text>
    
    <!-- 细胞条码 -->
    <g transform="translate(50, 50)">
      <text x="0" y="0" class="step-text" fill="#dc2626">细胞条码 (Cell Barcode)</text>
      <text x="0" y="20" class="desc-text">• 每个微滴包含唯一的细胞条码</text>
      <text x="0" y="35" class="desc-text">• 16个核苷酸长度，约65,000种组合</text>
      <text x="0" y="50" class="desc-text">• 用于区分不同细胞来源的转录本</text>
    </g>
    
    <!-- UMI -->
    <g transform="translate(400, 50)">
      <text x="0" y="0" class="step-text" fill="#dc2626">分子条码 (UMI)</text>
      <text x="0" y="20" class="desc-text">• 唯一分子标识符，12个核苷酸</text>
      <text x="0" y="35" class="desc-text">• 消除PCR扩增偏好性</text>
      <text x="0" y="50" class="desc-text">• 实现准确的分子计数</text>
    </g>
    
    <!-- 数据输出 -->
    <g transform="translate(200, 120)">
      <text x="0" y="0" class="step-text" fill="#059669">数据输出格式</text>
      <text x="0" y="20" class="desc-text">• 基因表达矩阵：基因 × 细胞</text>
      <text x="0" y="35" class="desc-text">• 每个细胞可检测10,000-20,000个基因</text>
      <text x="0" y="50" class="desc-text">• 单次实验可分析数千到数万个细胞</text>
    </g>
  </g>
  
  <!-- 技术优势 -->
  <g transform="translate(50, 440)">
    <text x="0" y="0" class="step-text" fill="#7c3aed">技术优势：</text>
    <text x="100" y="0" class="desc-text">高通量、标准化、成本效益好、数据质量高</text>
    
    <text x="450" y="0" class="step-text" fill="#7c3aed">应用领域：</text>
    <text x="550" y="0" class="desc-text">发育生物学、疾病研究、药物开发、免疫学</text>
  </g>
</svg>
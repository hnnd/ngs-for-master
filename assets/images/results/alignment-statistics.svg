<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title-text { font-family: 'Source Han Sans CN', sans-serif; font-size: 20px; font-weight: bold; fill: #1e3a8a; }
      .axis-text { font-family: 'Source Han Sans CN', sans-serif; font-size: 14px; fill: #374151; }
      .label-text { font-family: 'Source Han Sans CN', sans-serif; font-size: 12px; fill: #6b7280; }
      .value-text { font-family: 'Source Han Sans CN', sans-serif; font-size: 14px; font-weight: 600; }
    </style>
  </defs>
  
  <!-- 标题 -->
  <text x="400" y="30" text-anchor="middle" class="title-text">序列比对统计结果</text>
  
  <!-- 比对率饼图 -->
  <g transform="translate(150, 100)">
    <text x="0" y="-10" text-anchor="middle" class="axis-text">比对率统计</text>
    
    <!-- 饼图 -->
    <circle cx="0" cy="80" r="70" fill="#f3f4f6" stroke="#d1d5db" stroke-width="2"/>
    
    <!-- 成功比对 (85%) -->
    <path d="M 0 10 A 70 70 0 1 1 -49.5 49.5 L 0 80 Z" fill="#22c55e" stroke="white" stroke-width="2"/>
    
    <!-- 多重比对 (8%) -->
    <path d="M -49.5 49.5 A 70 70 0 0 1 -69.3 10.8 L 0 80 Z" fill="#f59e0b" stroke="white" stroke-width="2"/>
    
    <!-- 未比对 (7%) -->
    <path d="M -69.3 10.8 A 70 70 0 0 1 0 10 L 0 80 Z" fill="#ef4444" stroke="white" stroke-width="2"/>
    
    <!-- 标签 -->
    <text x="35" y="50" class="value-text" fill="#059669">85%</text>
    <text x="-60" y="30" class="value-text" fill="#d97706">8%</text>
    <text x="-35" y="0" class="value-text" fill="#dc2626">7%</text>
    
    <!-- 图例 -->
    <g transform="translate(-80, 170)">
      <rect x="0" y="0" width="15" height="15" fill="#22c55e"/>
      <text x="20" y="12" class="label-text">唯一比对</text>
      
      <rect x="0" y="25" width="15" height="15" fill="#f59e0b"/>
      <text x="20" y="37" class="label-text">多重比对</text>
      
      <rect x="0" y="50" width="15" height="15" fill="#ef4444"/>
      <text x="20" y="62" class="label-text">未比对</text>
    </g>
  </g>
  
  <!-- 比对质量分布 -->
  <g transform="translate(400, 100)">
    <text x="100" y="-10" text-anchor="middle" class="axis-text">比对质量分布</text>
    
    <!-- 坐标轴 -->
    <line x1="30" y1="150" x2="170" y2="150" stroke="#374151" stroke-width="2"/>
    <line x1="30" y1="20" x2="30" y2="150" stroke="#374151" stroke-width="2"/>
    
    <!-- 直方图 -->
    <rect x="35" y="140" width="15" height="10" fill="#ef4444"/>
    <rect x="55" y="130" width="15" height="20" fill="#f59e0b"/>
    <rect x="75" y="120" width="15" height="30" fill="#f59e0b"/>
    <rect x="95" y="100" width="15" height="50" fill="#22c55e"/>
    <rect x="115" y="70" width="15" height="80" fill="#22c55e"/>
    <rect x="135" y="50" width="15" height="100" fill="#22c55e"/>
    <rect x="155" y="80" width="15" height="70" fill="#22c55e"/>
    
    <!-- X轴标签 -->
    <text x="42" y="165" text-anchor="middle" class="label-text">0-10</text>
    <text x="62" y="165" text-anchor="middle" class="label-text">10-20</text>
    <text x="82" y="165" text-anchor="middle" class="label-text">20-30</text>
    <text x="102" y="165" text-anchor="middle" class="label-text">30-40</text>
    <text x="122" y="165" text-anchor="middle" class="label-text">40-50</text>
    <text x="142" y="165" text-anchor="middle" class="label-text">50-60</text>
    <text x="162" y="165" text-anchor="middle" class="label-text">60</text>
    
    <!-- Y轴标签 -->
    <text x="25" y="155" text-anchor="end" class="label-text">0</text>
    <text x="25" y="125" text-anchor="end" class="label-text">5K</text>
    <text x="25" y="95" text-anchor="end" class="label-text">10K</text>
    <text x="25" y="65" text-anchor="end" class="label-text">15K</text>
    <text x="25" y="35" text-anchor="end" class="label-text">20K</text>
    
    <!-- 轴标题 -->
    <text x="100" y="185" text-anchor="middle" class="label-text">比对质量分数(MAPQ)</text>
    <text x="10" y="85" text-anchor="middle" class="label-text" transform="rotate(-90, 10, 85)">reads数量</text>
  </g>
  
  <!-- 覆盖度统计 -->
  <g transform="translate(100, 320)">
    <text x="200" y="0" text-anchor="middle" class="axis-text">基因组覆盖度分布</text>
    
    <!-- 背景 -->
    <rect x="0" y="20" width="400" height="150" fill="#fafafa" stroke="#d1d5db" stroke-width="1"/>
    
    <!-- 覆盖度曲线 -->
    <path d="M 20 160 Q 50 140 80 120 Q 120 100 160 90 Q 200 85 240 90 Q 280 100 320 120 Q 350 140 380 160" 
          stroke="#3b82f6" stroke-width="3" fill="none"/>
    
    <!-- 填充区域 -->
    <path d="M 20 160 Q 50 140 80 120 Q 120 100 160 90 Q 200 85 240 90 Q 280 100 320 120 Q 350 140 380 160 L 380 160 L 20 160 Z" 
          fill="#3b82f6" fill-opacity="0.3"/>
    
    <!-- 坐标轴 -->
    <line x1="20" y1="170" x2="380" y2="170" stroke="#374151" stroke-width="2"/>
    <line x1="20" y1="30" x2="20" y2="170" stroke="#374151" stroke-width="2"/>
    
    <!-- X轴标签 -->
    <text x="50" y="185" text-anchor="middle" class="label-text">Chr1</text>
    <text x="120" y="185" text-anchor="middle" class="label-text">Chr2</text>
    <text x="200" y="185" text-anchor="middle" class="label-text">Chr3</text>
    <text x="280" y="185" text-anchor="middle" class="label-text">Chr4</text>
    <text x="350" y="185" text-anchor="middle" class="label-text">Chr5</text>
    
    <!-- Y轴标签 -->
    <text x="15" y="175" text-anchor="end" class="label-text">0</text>
    <text x="15" y="145" text-anchor="end" class="label-text">10X</text>
    <text x="15" y="115" text-anchor="end" class="label-text">20X</text>
    <text x="15" y="85" text-anchor="end" class="label-text">30X</text>
    <text x="15" y="55" text-anchor="end" class="label-text">40X</text>
    
    <!-- 轴标题 -->
    <text x="200" y="205" text-anchor="middle" class="label-text">染色体</text>
    <text x="0" y="100" text-anchor="middle" class="label-text" transform="rotate(-90, 0, 100)">平均覆盖度</text>
  </g>
  
  <!-- 统计数据表格 -->
  <g transform="translate(450, 320)">
    <text x="100" y="0" text-anchor="middle" class="axis-text">比对统计摘要</text>
    
    <!-- 表格背景 -->
    <rect x="0" y="20" width="200" height="180" fill="#f9fafb" stroke="#d1d5db" stroke-width="1"/>
    
    <!-- 表格内容 -->
    <g transform="translate(10, 40)">
      <text x="0" y="0" class="label-text">总reads数：</text>
      <text x="120" y="0" class="value-text" fill="#1e3a8a">10,000,000</text>
      
      <text x="0" y="20" class="label-text">成功比对：</text>
      <text x="120" y="20" class="value-text" fill="#059669">8,500,000 (85%)</text>
      
      <text x="0" y="40" class="label-text">多重比对：</text>
      <text x="120" y="40" class="value-text" fill="#d97706">800,000 (8%)</text>
      
      <text x="0" y="60" class="label-text">未比对：</text>
      <text x="120" y="60" class="value-text" fill="#dc2626">700,000 (7%)</text>
      
      <line x1="0" y1="75" x2="180" y2="75" stroke="#d1d5db" stroke-width="1"/>
      
      <text x="0" y="95" class="label-text">平均覆盖度：</text>
      <text x="120" y="95" class="value-text" fill="#1e3a8a">25.6X</text>
      
      <text x="0" y="115" class="label-text">覆盖率(>1X)：</text>
      <text x="120" y="115" class="value-text" fill="#059669">98.5%</text>
      
      <text x="0" y="135" class="label-text">覆盖率(>10X)：</text>
      <text x="120" y="135" class="value-text" fill="#059669">95.2%</text>
      
      <text x="0" y="155" class="label-text">重复率：</text>
      <text x="120" y="155" class="value-text" fill="#f59e0b">12.3%</text>
    </g>
  </g>
  
  <!-- 底部说明 -->
  <g transform="translate(50, 550)">
    <rect x="0" y="0" width="700" height="40" fill="#f0f9ff" stroke="#0ea5e9" stroke-width="1" rx="5"/>
    <text x="10" y="20" class="label-text" font-weight="600">质量评估标准：</text>
    <text x="120" y="20" class="label-text">比对率 &gt; 80% | 平均覆盖度 &gt; 20X | 重复率 &lt; 20% | MAPQ &gt; 30</text>
    <text x="10" y="35" class="label-text">工具：samtools stats, bamtools stats, Picard CollectAlignmentSummaryMetrics</text>
  </g>
</svg>
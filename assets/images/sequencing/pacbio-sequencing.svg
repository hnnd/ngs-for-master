<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title-text { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; fill: #333; }
      .step-text { font-family: Arial, sans-serif; font-size: 12px; fill: #333; }
      .label-text { font-family: Arial, sans-serif; font-size: 10px; fill: #666; }
      .dna-strand { stroke: #2196F3; stroke-width: 3; fill: none; }
      .zmw { fill: #FFD700; stroke: #FF8C00; stroke-width: 2; }
      .polymerase { fill: #4CAF50; }
      .phosphate { fill: #F44336; }
      .laser { stroke: #FF0000; stroke-width: 2; }
    </style>
  </defs>
  
  <!-- 背景 -->
  <rect width="800" height="600" fill="#fafafa"/>
  
  <!-- 标题 -->
  <text x="400" y="30" text-anchor="middle" class="title-text">PacBio SMRT测序技术原理</text>
  
  <!-- SMRT芯片结构 -->
  <g transform="translate(50, 60)">
    <text x="0" y="0" class="step-text" font-weight="bold">SMRT芯片结构</text>
    
    <!-- 芯片基底 -->
    <rect x="20" y="20" width="300" height="150" fill="#E0E0E0" stroke="#333" stroke-width="2" rx="5"/>
    <text x="170" y="180" text-anchor="middle" class="label-text">SMRT芯片</text>
    
    <!-- ZMW孔阵列 -->
    <g>
      <!-- 第一行ZMW -->
      <circle cx="60" cy="60" r="15" class="zmw"/>
      <circle cx="100" cy="60" r="15" class="zmw"/>
      <circle cx="140" cy="60" r="15" class="zmw"/>
      <circle cx="180" cy="60" r="15" class="zmw"/>
      <circle cx="220" cy="60" r="15" class="zmw"/>
      <circle cx="260" cy="60" r="15" class="zmw"/>
      
      <!-- 第二行ZMW -->
      <circle cx="60" cy="100" r="15" class="zmw"/>
      <circle cx="100" cy="100" r="15" class="zmw"/>
      <circle cx="140" cy="100" r="15" class="zmw"/>
      <circle cx="180" cy="100" r="15" class="zmw"/>
      <circle cx="220" cy="100" r="15" class="zmw"/>
      <circle cx="260" cy="100" r="15" class="zmw"/>
      
      <!-- 第三行ZMW -->
      <circle cx="60" cy="140" r="15" class="zmw"/>
      <circle cx="100" cy="140" r="15" class="zmw"/>
      <circle cx="140" cy="140" r="15" class="zmw"/>
      <circle cx="180" cy="140" r="15" class="zmw"/>
      <circle cx="220" cy="140" r="15" class="zmw"/>
      <circle cx="260" cy="140" r="15" class="zmw"/>
    </g>
    
    <text x="170" y="200" text-anchor="middle" class="label-text">零模波导孔 (ZMW) 阵列</text>
  </g>
  
  <!-- ZMW详细结构 -->
  <g transform="translate(400, 60)">
    <text x="0" y="0" class="step-text" font-weight="bold">零模波导 (ZMW) 结构</text>
    
    <!-- ZMW截面图 -->
    <rect x="20" y="20" width="200" height="150" fill="#f9f9f9" stroke="#333" stroke-width="2" rx="5"/>
    
    <!-- ZMW孔 -->
    <circle cx="120" cy="95" r="40" fill="#FFD700" stroke="#FF8C00" stroke-width="3"/>
    <circle cx="120" cy="95" r="25" fill="#FFF" stroke="#FF8C00" stroke-width="2"/>
    
    <!-- DNA聚合酶 -->
    <circle cx="120" cy="95" r="8" class="polymerase"/>
    <text x="120" y="100" text-anchor="middle" class="label-text" fill="white" font-size="8">Pol</text>
    
    <!-- DNA模板 -->
    <path d="M 95 95 Q 120 85 145 95" class="dna-strand"/>
    <path d="M 95 100 Q 120 110 145 100" class="dna-strand"/>
    
    <!-- 激光照射 -->
    <path d="M 120 40 L 120 70" class="laser" marker-end="url(#arrowhead)"/>
    <text x="125" y="35" class="label-text">激光</text>
    
    <!-- 检测区域标记 -->
    <circle cx="120" cy="95" r="30" fill="none" stroke="#FF0000" stroke-width="2" stroke-dasharray="5,5"/>
    <text x="155" y="90" class="label-text">检测区域</text>
    
    <text x="120" y="185" text-anchor="middle" class="label-text">直径 ~100nm</text>
  </g>
  
  <!-- 测序反应过程 -->
  <g transform="translate(50, 280)">
    <text x="0" y="0" class="step-text" font-weight="bold">单分子实时测序过程</text>
    
    <!-- 步骤1 -->
    <g transform="translate(0, 20)">
      <rect x="0" y="0" width="120" height="80" fill="#E3F2FD" stroke="#2196F3" stroke-width="2" rx="5"/>
      <text x="60" y="15" text-anchor="middle" class="label-text" font-weight="bold">步骤1</text>
      <text x="60" y="30" text-anchor="middle" class="label-text">DNA聚合酶结合</text>
      <text x="60" y="45" text-anchor="middle" class="label-text">模板和引物</text>
      
      <!-- 简化示意图 -->
      <circle cx="60" cy="60" r="8" class="polymerase"/>
      <path d="M 40 60 L 80 60" class="dna-strand"/>
    </g>
    
    <!-- 箭头 -->
    <path d="M 130 60 L 150 60" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- 步骤2 -->
    <g transform="translate(160, 20)">
      <rect x="0" y="0" width="120" height="80" fill="#FFF3E0" stroke="#FF9800" stroke-width="2" rx="5"/>
      <text x="60" y="15" text-anchor="middle" class="label-text" font-weight="bold">步骤2</text>
      <text x="60" y="30" text-anchor="middle" class="label-text">荧光dNTP结合</text>
      <text x="60" y="45" text-anchor="middle" class="label-text">聚合酶活性位点</text>
      
      <!-- 荧光dNTP -->
      <circle cx="60" cy="60" r="8" class="polymerase"/>
      <circle cx="75" cy="55" r="3" class="phosphate"/>
      <path d="M 40 60 L 80 60" class="dna-strand"/>
    </g>
    
    <!-- 箭头 -->
    <path d="M 290 60 L 310 60" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- 步骤3 -->
    <g transform="translate(320, 20)">
      <rect x="0" y="0" width="120" height="80" fill="#E8F5E8" stroke="#4CAF50" stroke-width="2" rx="5"/>
      <text x="60" y="15" text-anchor="middle" class="label-text" font-weight="bold">步骤3</text>
      <text x="60" y="30" text-anchor="middle" class="label-text">荧光信号检测</text>
      <text x="60" y="45" text-anchor="middle" class="label-text">碱基识别</text>
      
      <!-- 荧光信号 -->
      <circle cx="60" cy="60" r="8" class="polymerase"/>
      <circle cx="75" cy="55" r="3" fill="#FF0000"/>
      <path d="M 75 50 L 75 40" stroke="#FF0000" stroke-width="2"/>
      <path d="M 40 60 L 80 60" class="dna-strand"/>
    </g>
    
    <!-- 步骤4 -->
    <g transform="translate(160, 120)">
      <rect x="0" y="0" width="120" height="80" fill="#F3E5F5" stroke="#9C27B0" stroke-width="2" rx="5"/>
      <text x="60" y="15" text-anchor="middle" class="label-text" font-weight="bold">步骤4</text>
      <text x="60" y="30" text-anchor="middle" class="label-text">磷酸基团释放</text>
      <text x="60" y="45" text-anchor="middle" class="label-text">DNA链延伸</text>
      
      <!-- 延伸后 -->
      <circle cx="60" cy="60" r="8" class="polymerase"/>
      <path d="M 40 60 L 85 60" class="dna-strand"/>
      <text x="90" y="65" class="label-text" font-size="8">+1</text>
    </g>
  </g>
  
  <!-- 技术优势 -->
  <g transform="translate(500, 280)">
    <text x="0" y="0" class="step-text" font-weight="bold">技术特点</text>
    
    <rect x="0" y="10" width="200" height="180" fill="#f9f9f9" stroke="#ddd" stroke-width="1" rx="5"/>
    
    <text x="10" y="30" class="label-text" font-weight="bold">优势：</text>
    <text x="10" y="45" class="label-text">• 长读长 (平均15kb)</text>
    <text x="10" y="60" class="label-text">• 单分子测序</text>
    <text x="10" y="75" class="label-text">• 实时检测</text>
    <text x="10" y="90" class="label-text">• 无PCR偏向</text>
    <text x="10" y="105" class="label-text">• 可检测表观修饰</text>
    
    <text x="10" y="125" class="label-text" font-weight="bold">局限性：</text>
    <text x="10" y="140" class="label-text">• 错误率较高 (~5%)</text>
    <text x="10" y="155" class="label-text">• 成本较高</text>
    <text x="10" y="170" class="label-text">• 通量相对较低</text>
    <text x="10" y="185" class="label-text">• 需要高质量DNA</text>
  </g>
  
  <!-- 应用场景 -->
  <g transform="translate(50, 480)">
    <text x="0" y="0" class="step-text" font-weight="bold">主要应用</text>
    
    <rect x="0" y="10" width="300" height="80" fill="#f0f8ff" stroke="#4682b4" stroke-width="1" rx="5"/>
    
    <text x="10" y="30" class="label-text">• 基因组从头组装 (De novo assembly)</text>
    <text x="10" y="45" class="label-text">• 结构变异检测 (SV detection)</text>
    <text x="10" y="60" class="label-text">• 全长转录本测序 (Iso-seq)</text>
    <text x="10" y="75" class="label-text">• 表观遗传学研究 (甲基化检测)</text>
  </g>
  
  <!-- 数据特征 -->
  <g transform="translate(400, 480)">
    <text x="0" y="0" class="step-text" font-weight="bold">数据特征</text>
    
    <rect x="0" y="10" width="200" height="80" fill="#fff5f5" stroke="#ff6b6b" stroke-width="1" rx="5"/>
    
    <text x="10" y="30" class="label-text">• 读长分布: 500bp - 100kb+</text>
    <text x="10" y="45" class="label-text">• 错误模式: 随机分布</text>
    <text x="10" y="60" class="label-text">• 质量提升: HiFi技术</text>
    <text x="10" y="75" class="label-text">• 产出: ~160GB/SMRT Cell</text>
  </g>
  
  <!-- 箭头标记定义 -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>
</svg>